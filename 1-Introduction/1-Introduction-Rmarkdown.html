<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>An Introduction to R + Markdown</title>
    <meta charset="utf-8" />
    <meta name="author" content="R. Burke Squires" />
    <meta name="date" content="2021-09-20" />
    <script src="libs/header-attrs-2.10/header-attrs.js"></script>
    <link rel="stylesheet" href="mckpam.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# An Introduction to R + Markdown
## Enabling Reproducible Science
### R. Burke Squires
### September 20, 2021

---


# R Markdown

-	Introduction &amp; Overview
-	Installation
-	How It Works 
-	Components
  - Lunch
-	Analyze
-	Output


---

# Introduction

**Reproducible Data Science**

- In a biology wet lab researchers must keep a lab notebook - why should computational experiments be any different?

--

- Why do scientists keep a lab notebook?

--

- You should be able to go back to a coding project 10 years later, or send code to a colleague, and not only reproduce the same results - but understand why you got them!

---

# Literate Computing

- This isn’t a new idea
--

- Donald Knuth published **Literate Programming** in 1983
--

- A single document describes an analysis using **natural language** and **code snippets**
--

- Mathematica implemented a notebook in 1988.
--

- More recently, we’ve seen a resurgence of this with *IPython*, now *Jupyter* notebooks (which support many languages).
--

- **R Markdown fits right into this paradigm!**

---

# What is Markdown?

- Markdown is a programming language to enable basic text files to be easily exported to (X)HTML

--
- Created in 2004 by John Gruber in collaboration with the late Aaron Swartz

--
- Emphasis is placed on **readability** - the **.md** or **.markdown** files can be read on their own

--
- Markdown is an informal specification, in 2016 groups started to make formal variants: MultiMarkdown, GitHub Flavored Markdown (GFM), **Pandoc**, CommonMark, etc.

---

# Another Programming Language???

![Markdown is a programming language?](images/fear.jpg)

---

# RELAX!

---

# Markdown

- Markdown enables you to communicate your thoughts to your collaborators and your future self,

- Combining text, documented code, even math, 

- and **no fuss**.

---

# Markdown Playground

- Lets practice some markdown!

- Open a browser window and go to: https://stackedit.io/app

- This will enable you to write teh markdown and see how it is formatted at the same time

---

# What Markdown looks like

- Please type this in the stackedit.io window

````{.markdown}
Text formatting
===============

Inline markup
-------------

**Paragraphs** begin and end 
with empty lines, and are *not* indented.

- **bold** and *emphasis*
- ~~strikeout~~
- super^scripts^ and sub~scripts~
- and `inline_code($fixed.width)`

````

---

# What Markdown Formats to:

- Does your output look like this?

### Text formatting

#### Inline markup

**Paragraphs** begin and end with empty lines, and are *not* indented.

- **bold** and *emphasis*
- ~~strikeout~~
- super^scripts^ and sub~scripts~
- and `inline_code($fixed.width)`

---

# Lists

````{.markdown}
Lists must be preceded by an empty line,

1.  ordered or unordered.
 1.  Indenting subsequent content
    
    -  will continue the list

        *   and nest
        *   other lists.

1.  *Indenting* means one tab, or four spaces.
````

---

# Lists

Lists must be preceded by an empty line,

1.  ordered or unordered.
1.  Indenting subsequent content
    
    -  will continue the list

        *  and nest
        *  other lists.

1.  *Indenting* means one tab, or four spaces.

---

# Markdown Can Do Math

```
- Math goes between `$`, single ($\pi$), or double: 
$$ \frac{\pi}{4} = \sum_{n=0}^\infty \frac{(-1)^n}{2k+1} .$$
```

- Math goes between `$`, single ($\pi$), or double: 
`$$\frac{\pi}{4} = \sum_{n=0}^\infty \frac{(-1)^n}{2k+1} .$$`


---

# Markdown Can Do Math

- Even math environments *inside* double dollar signs:

```{.md}
$$
\begin{align}
    x &amp;= (a+b)^2 - (a-b)^2 \\
      &amp;= 4ab
\end{align}
$$
```

`\begin{align}
    x &amp;= (a+b)^2 - (a-b)^2 \\
      &amp;= 4ab
\end{align}`


---

# Code blocks

````

```r
msg &lt;- "Hello, world."
print(msg)
```

```
## [1] "Hello, world."
```
````

````{.r}
msg &lt;- "Hello, world."
print(msg)
````


**produces**


```r
msg &lt;- "Hello, world."
print(msg)
```

```
## [1] "Hello, world."
```


---

# Blockquotes

````
&gt; I also dream about a modern replacement for LaTeX 
&gt; designed from the ground up to target multiple output formats 
&gt; (at least PDF, HTML, EPUB). -- [John MacFarlane](http://john.macfarlane.usesthis.com/)
````

**produces**

&gt; I also dream about a modern replacement for LaTeX 
&gt; designed from the ground up to target multiple output formats 
&gt; (at least PDF, HTML, EPUB). -- [John MacFarlane](http://john.macfarlane.usesthis.com/)


---

# Links

A [link](https://rmarkdown.rstudio.com) just go in parentheses, 
and can be [internal](#links-and-images).

```{.markdown}
A [link](https://rmarkdown.rstudio.com) just go in parentheses, 
and can be [internal](#links-and-images).
```

---

# Images

Images are **the same** but with a `!` in front. \
Setting width and height are optional.

```{.markdown}
![oh, internet](images/cat-pandoc.jpg){width=300px height=300px}
```

![oh, internet](images/cat-pandoc.jpg){width=300px height=300px}

---

# Questions about Markdown?

- People use Markdown in many places:
  - RMarkdown documents
  - Jupyter notebooks
  - GitHub
  - [Websites](https://www.markdownguide.org/getting-started/#websites)
  - [Documents](https://www.markdownguide.org/getting-started/#documents)
  - [Notes](https://www.markdownguide.org/getting-started/#notes)
  - [Books](https://www.markdownguide.org/getting-started/#books)
  - [Presentations](https://www.markdownguide.org/getting-started/#presentations)
  - [Email messages](https://www.markdownguide.org/getting-started/#email)
  - [Technical documentation](https://www.markdownguide.org/getting-started/#documentation)

- Check out the [Markdown Guide](https://www.markdownguide.org/cheat-sheet/)
- After using markdown for a bit, go read [pandoc's documentation](http://pandoc.org/README.html).

---

# Are You Ready To Learn About R + Markdown?

---

# R Markdown Overview

- R Markdown provides an authoring framework for data science

--

- You can use a single R Markdown file to both

  - Save and execute code

  - Generate high quality reports that can be shared

--

- R Markdown documents
  - Fully reproducible 
  - Support dozens of static and dynamic output formats

---

# What is possible with RMarkdown

- Lets see what is possiblew with R Markdown [Gallery](https://rmarkdown.rstudio.com/gallery.html).

--

- I suggest you download (and print) the [RMarkdown cheatsheet](cheatsheeets/rmarkdown-reference.pdf)

---

# R Markdown vs Notebook vs Script

|                 | R Markdown | R Notebook  |  R Script | 
|-----------------|------------|:-----------:|----------:|
| Extension       | .Rmd       | .Rmd        | .R        |
| Run R code?     | Yes        | Yes         | Yes       |
| Narrative Text? | Yes        | Yes         | No        |
| Format output?  | Yes        | No          | No        |


- *R Notebook vs RMarkdown*
  - Same file format - the difference is how YOU work with it.

- When you want to extract all R code from an R Markdown document, you can call the function `knitr::purl()`

---

# Difference between RMarkdown and RNotebooks

- R Markdown documents are ‘knitted’, while R Notebooks are ‘previewed’.

- Notebook preview does not execute any code chunks, 
  - Only shows a rendered copy of the Markdown output with most recent chunk output. 
  - Preview is generated automatically whenever the notebook is saved. 

- Note: R Markdown Notebooks are only available in RStudio 1.0 or higher.


---

#	How Do You Get R Markdown

**Installation**

- Like the rest of R, R Markdown is free and open source 
- You can install the R Markdown package from CRAN with:

  `install.packages("rmarkdown")`

---

#	How Does R Markdown Works?

![How it works](images/rmarkdownflow.png)

- When you run render, R Markdown feeds the .Rmd file to `knitr`, which executes all of the code chunks and creates a new markdown (.md) document which includes the code and its output.

- The markdown file generated by `knitr` is then processed by `pandoc` which is responsible for creating the finished format.

- May sound complicated, but R Markdown makes it simple...a single render function.

---

# Workflow

An example RMarkdown workflow:

1. Open a **new .Rmd file** in the RStudio IDE by going to ~File &gt; New File &gt; R Markdown~
2. **Embed code** in chunks. Run code by line, by chunk, or all at once.
3. **Write text** and add tables, figures, images, and citations. Format with Markdown syntax or the RStudio Visual Markdown Editor.
4. **Set output format(s) and options** in the YAML header. Customize themes or add parameters to execute or add interactivity with Shiny.
5. **Save and render** the whole document. Knit periodically to preview your work as you write. 6. **Share your work!**


---

# Anatomy of an R Markdown File

Open `RStudio` -&gt; `File` -&gt; `New file` -&gt; `Rmarkdown` -&gt; Click `OK`

Notice that the file contains three types of content:

- An (optional) YAML header surrounded by three dashes
- R code chunks surrounded by three backticks
- Text mixed with simple text formatting

---

# Anatomy of an R Markdown File

**Header (YAML)**

- Three dashes (to open)
- Title
- Author
- Date
- Output format(s)(Used for compiling - multiple output formats can be written here!)
- Three dashes (to close)

**Body Options**

- Code Chunks
- Inline Code
- Parameters
- Tables
- Markdown


---

# Code Chunks: Adding in R

**Goal:**

add R code to the document,

*along with its output*.

Go ahead

Just add a *chunk* of R code, wrapped in

````


```r
1 + 1
```

```
## [1] 2
```
````

---

# Code Chunks: Adding in R

**Try it!**

Powers of two?
````


```r
2^(0:10)
```

```
##  [1]    1    2    4    8   16   32   64  128  256  512 1024
```
````

Powers of two?


```r
2^(0:10)
```

```
##  [1]    1    2    4    8   16   32   64  128  256  512 1024
```

---

# Code Chunks: Adding in R

How about this?
````
$$ \lim_{n \to \infty} 4 \sum_{k=1}^n \frac{ (-1)^n }{ 2n+1 } = \pi , $$
````

$$ \lim_{n \to \infty} 4 \sum_{k=0}^n \frac{ (-1)^n }{ 2n+1 } = \pi , $$

---

# Code Chunks: Adding in R

````

  
  ```r
  cumsum( 4 * (-1)^(0:20) / (2*(0:20)+1) )
  ```
  
  ```
  ##  [1] 4.000000 2.666667 3.466667 2.895238 3.339683 2.976046 3.283738 3.017072
  ##  [9] 3.252366 3.041840 3.232316 3.058403 3.218403 3.070255 3.208186 3.079153
  ## [17] 3.200366 3.086080 3.194188 3.091624 3.189185
  ```
````

. . .


```r
cumsum( 4 * (-1)^(0:20) / (2*(0:20)+1) )
```

```
##  [1] 4.000000 2.666667 3.466667 2.895238 3.339683 2.976046 3.283738 3.017072
##  [9] 3.252366 3.041840 3.232316 3.058403 3.218403 3.070255 3.208186 3.079153
## [17] 3.200366 3.086080 3.194188 3.091624 3.189185
```

---

# Code Chunks: Adding in R

````


```r
plot(cumsum( 4 * (-1)^(0:20) / (2*(0:20)+1) ))
abline(h=pi, col='red')
```

![](1-Introduction-Rmarkdown_files/figure-html/unnamed-chunk-8-1.png)&lt;!-- --&gt;
````

. . .



```r
plot(cumsum( 4 * (-1)^(0:20) / (2*(0:20)+1) ))
abline(h=pi, col='red')
```

![](1-Introduction-Rmarkdown_files/figure-html/unnamed-chunk-9-1.png)&lt;!-- --&gt;


---

#Code Chunks vs Inline Code

**Options are set like: ```{r this-chunk-name, my-options-go-here=TRUE/FALSE}**

Common Options:
- **eval**: TRUE/FALSE - Whether to evaluate a code chunk.
- **echo**: TRUE/FALSE - Whether to echo the source code in the output document
- **results**: hide/asis - Set to 'hide’ text or simply output code just as it is written
- **warning, message, error**: TRUE/FALSE - Whether to show warnings, messages, and errors in the output
- **include**: TRUE/FALSE - Whether to include anything from a code chunk in the output document.  NOTE: include=FALSE means echo = FALSE, results = 'hide', warning = FALSE, and message = FALSE
- **cache**: TRUE/FALSE - If caching is enabled, the same code chunk will not be evaluated the next time fig.width and fig.height: No. - Size of R plots in inches can combine as: fig.dim = c(6, 4)
- **out.width** and **out.height**: “No.%” – Page with of plot output e.g., out.width = '80%' means 80% of width
- **fig.align**: left/center/right - The alignment of plots
- **dev**: pdf/png/svg - The device format to record plots, usually 'pdf' for LaTeX, 'png’ for HTML output
- **fig.cap**: string - The figure caption

---

# Exercise

???

---

# Code Chunks: Adding in R

- You can quickly insert chunks like these into your file with 
  - the keyboard shortcut Ctrl + Alt + I (OS X: Cmd + Option + I)
  - the Add Chunk  command in the editor toolbar
  - or by typing the chunk delimiters ```{r} and ```.

When you render your .Rmd file, R Markdown will run each code chunk and embed the results beneath the code chunk in your final report.

---

# Code Chunks: Adding in R

- Code chunks can be displayed or not using options

````


```
##  [1]    1    2    4    8   16   32   64  128  256  512 1024
```
````

- echo (default=TRUE): display code in the document
- eval (default=TRUE): run the code in the chunk
- tidy (default=FALSE): tidy the code displayed
- message (default=TRUE): display code messages in the document 
- include (default=TRUE): include the chunk in the document
- warning (default=TRUE): display code warnings in the document

See more here: https://bookdown.org/yihui/rmarkdown-cookbook/r-code.html

---

# Inline Code

- Code results can be inserted directly into the text of a .Rmd file by enclosing the code with `r `. The file below uses `r ` twice to call colorFunc, which returns “heat.colors.”


```r
colorfunc &lt;- "heat.colors"
# colorfunc &lt;- "terrain.colors"
```

Base R comes with many functions for generating colors. The code below demonstrates the heat.colors function.

---

# Code Languages

- `knitr` can execute code in many languages besides R. 

- Some of the available language engines include:
  - Python
  - SQL
  - Bash
  - Rcpp
  - JavaScript
  - CSS

- To process a code chunk using an alternate language engine, replace the r at the start of your chunk declaration with the name of the language


```bash
pwd
```

```
## /Users/squiresrb/Documents/GitHub/r-markdown-tutorial/1-Introduction
```
- Note that chunk options like echo and results are all valid when using a language engine like python.

- Note, *except for python*, these sessions are closed at the end of each code chunk so variables do not persist throughout the document

https://bookdown.org/yihui/rmarkdown-cookbook/r-code.html

---

# Challenge

???

---

# Code Languages

**Lets list some parts of the cell!**


```python
parts = ['nucleus','ribosome','plasma membrane','mitochondria','endoplasmic reticulum']
for p in parts:
  print(p)
```

```
## nucleus
## ribosome
## plasma membrane
## mitochondria
## endoplasmic reticulum
```

**Lets list some types of bacteria by genus!**

#```{ruby ruby-chunk}
#bacs = ['Micrococcus','Staphylococcus','Bacillus','Pseudomona']
#bacs.each {|b| puts b}
#```

---

# Parameters

Click [here](https://rstudio.cloud/project/181942) to open in RStudio.cloud

![parameters](images/params-1-hawaii.png){ width=75% height=75% }

---

# Parameters

R Markdown documents can include one or more parameters whose values can be set when you render the report. In the previous image, uses a data parameter that determines which data set to plot.

**Declaring Parameters**
Parameters are declared using the params field within the YAML header of the document. For example, the file above creates the parameter data and assigns it the default value "hawaii".

**Using Parameters in Code**
Parameters are made available within the knit environment as a read-only list named params. To access a parameter in code, call params$&lt;parameter name&gt;.

**Setting Parameters values**
Add a params argument to render to create a report that uses a new set of parameter values. Here we modify our report to use the aleutians data set with


---

# Tables

![Tables](images/tables-1-kable.png){ width=75% height=75% }

Check this out: https://www.tablesgenerator.com/markdown_tables

---

# Exercise / Challenge

The *NIEHS_NTP_SUBSTANCES.csv* data set from the National Toxicology Program has a list of known toxic substances that are studied at NIEHS.

*Challenge*: Your boss needs to set their budget next year to buy lab equipment and make supplier contracts. They ask you to create an HTML table with the following columns to include in their report: Substance Category, Substance Name, Analysis Method, and Supplier.

Try to make the nicest looking table you can!


---

# Lunch

## Questions?


---

# This presentation was adapted from these sources

- Peter Ralph, Univ. of Oregon, [Rmarkdown Tutorial](https://github.com/petrelharp/r-markdown-tutorial)
- RStudio's [Rmarkdown Introduction](https://rmarkdown.rstudio.com/lesson-1.html)
- Dan Veltri's [Introduction to R Markdown](https://bioinformatics.niaid.nih.gov/resources#10.4.4)

---

# Resources

*Cheatsheets*
- Look in the cheatsheets folder
  - [RMarkdown cheatsheet](cheatsheeets/rmarkdown-reference.pdf)
  
*Books*
- [R Markdown: The Definitive Guide](https://bookdown.org/yihui/rmarkdown/)
- [R Markdown Cookbook](https://bookdown.org/yihui/rmarkdown-cookbook/)
- [R for Health Data Science](https://argoshare.is.ed.ac.uk/healthyr_book/the-anatomy-of-a-notebook-r-markdown-file.html)
- [Applied Statistics for Experimental Biology](https://www.middleprofessor.com/files/applied-biostatistics_bookdown/_book/)

*Other*
- [R Markdown Reference Guide](https://www.rstudio.com/wp-content/uploads/2015/03/rmarkdown-reference.pdf)
- [Karl Broman's](http://kbroman.org/knitr_knutshell/pages/Rmarkdown.html) intro to R Markdown
- [Stack](http://stackoverflow.com/questions/tagged/rmarkdown)[Overflow](http://stackoverflow.com/questions/tagged/knitr)
- http://rmarkdown.rstudio.com/authoring_pandoc_markdown.html

*Book Writing*
- [bookdown: Authoring Books and Technical Documents with R Markdown](https://bookdown.org/yihui/bookdown/)

*Websites*
- [R Markdown website building tutorial](https://www.emilyzabor.com/tutorials/rmarkdown_websites_tutorial.html)
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
